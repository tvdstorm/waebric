
ometa Waebric <: Parser {

  Module          = "module" space ModuleId space ModuleElement spaces end,
  ModuleId        = IdCon ("." IdCon)*,
  ModuleElement   = Site,
  Site            = "site" spaces Mappings spaces "end",
  Mappings        = listOf(#Mapping, ';'),
  Mapping         = Path spaces ":" spaces Markup,
  Path            = IdCon "." IdCon,
  Markup          = Designator Arguments
                  | Designator, 
  Arguments       = "(" listOf(#Argument, ',') ")",
  Argument        = Expression
                  | Var "=" Expression,
  Expression      = Var 
                  | NatCon
                  | Expression "." IdCon
                  | "'" Expression "'",
  Designator      = IdCon,
  Attribute       = ("#" | "." | "$" | ":") IdCon
                  | "@" w:NatCon "%" h:NatCon
                  | "@" w:NatCon,
  Var             = IdCon,
  IdCon           = letterOrDigit+,
  NatCon          = digit+
}

program = "
           module homepage.cwi.nl

           site
             index.html:home('test')
           end
          "
alert(Waebric.matchAll(program, "Module"))